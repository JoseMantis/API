<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos API</title>
</head>
<body>
    <h1>Formulario de Productos</h1>
    <form id="CompraForm">
        <label for="nombreProducto">Nombre del Producto:</label>
        <input type="text" id="nombreProducto" name="nombreProducto" required>
        <br><br>
        <label for="precioProducto">Precio:</label>
        <input type="number" id="precioProducto" name="precioProducto" required>
        <br><br>
        <label for="nombreCliente">Nombre del cliente:</label>
        <input type="text" id="nombreCliente" name="nombreCliente" required>
        <br><br>
        <label for="direccion">Direccion:</label>
        <input type="text" id="direccion" name="direccion" required>
        <br><br>
        <label for="rut">Rut:</label>
        <input type="text" id="rut" name="rut" required>
        <br><br>

        <button type="submit">Agregar Datos</button>
    </form>

    <h2>Productos Disponibles:</h2>
    <button id="mostrarProductos">Mostrar Productos</button>
    <div id="productosContainer"></div>

    <h2>Clientes Registrados:</h2>
    <button id="mostrarClientes">Mostrar Clientes</button>
    <div id="clientesContainer"></div>

    <script>
        document.getElementById('CompraForm').addEventListener('submit', function (event) {
            event.preventDefault();

            const nombreCliente = document.getElementById('nombreCliente').value;
            const rutCliente = document.getElementById('rut').value;
            const direccionCliente = document.getElementById('direccion').value;
            const nombreProducto = document.getElementById('nombreProducto').value;
            const precioProducto = document.getElementById('precioProducto').value;

            const producto = {
                NombreProducto: nombreProducto,
                Precio: parseInt(precioProducto, 10)
            };

            const cliente = {
                RazonSocial : nombreCliente,
                Direccion : direccionCliente,
                Rut : rutCliente
            }

            fetch('http://localhost:5001/api/Productos', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(producto)
            })
            .then(response => response.json())
            .then(data => {
                alert('Producto agregado exitosamente');
                //document.getElementById('CompraForm').reset();
            })
            .catch(error => {
                console.error('Error al agregar producto:', error);
            });

            fetch('http://localhost:5000/api/Clientes', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(cliente)
            })
            .then(response => response.json())
            .then(data => {
                alert('Cliente Agregado Exitosamente');
                document.getElementById('CompraForm').reset();
            })
            .catch(error => {
                console.error('Error al agregar producto:', error);
            });
        });

        document.getElementById('mostrarClientes').addEventListener('click', function() {
            fetch('http://localhost:5000/api/Clientes', {
                method: 'GET',
                headers: {
                    'content_Type': 'application/json',

                }
            }).then(response => response.json())
              .then(data => {
                const clientesContainer = document.getElementById('clientesContainer');
                clientesContainer.innerHTML = '';

                data.forEach(cliente => {
                    const div = document.createElement('div');
                    div.textContent = 'ID: ${cliente.id}, NombreCliente: ${cliente.razonSocial}, Direccion: ${cliente.direccion}, Rut: ${cliente.rut}';
                    productosContainer.appendChild(div);
                })
              })
            .catch(Error => {
                console.error('Error al obtener Clientes', error);
            });
        });

        document.getElementById('mostrarProductos').addEventListener('click', function() {
            fetch('http://localhost:5001/api/Productos', {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',

                }
            })
            .then(response => response.json())
            .then(data => {
                const productosContainer = document.getElementById('productosContainer');
                productosContainer.innerHTML = ''; // Limpiar el contenedor antes de agregar los productos

                data.forEach(producto => {
                    const div = document.createElement('div');
                    div.textContent = `ID: ${producto.id}, Nombre: ${producto.nombreProducto}, Precio: ${producto.precio}`;
                    productosContainer.appendChild(div);
                });
            })
            .catch(error => {
                console.error('Error al obtener productos:', error);
            });
        });


    </script>
</body>
</html>